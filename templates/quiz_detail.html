{#main page html - 달력#}
{% extends 'index_side.html' %}

<!-- title, css, javascript 를 위한 block -->
{% block head_content %}
{#    title#}
    <title>Quiz</title>
    {% load static %}
{#    css#}
    <link rel="stylesheet" href="{% static 'css/quizz_detail.css' %}">
    <link rel="stylesheet" href="{% static 'css/modal.css' %}">

{#    javscript#}
{% endblock %}

{# TemplateHTMLRenderer를 사용하기 위해 rest_framework load#}
{% load rest_framework %}
{% block body_content %}
    <!-- deck 정보  -->
    <div class="quiz-info">
        <!-- 작성자만 볼 수 있는 버튼: 수정/삭제 추가 버튼  -->
        {% if user.student_id == owner %}
            <button class="btn-open-modal">수정하기</button>
            <button class="btn-open-modal">삭제하기</button>
        {% endif %}
        <br>
        <br>
        <!-- deck 상세 정보  -->
        <span class="label">과목:</span>
        <span class="info">{{ subject }}</span>
        <br>
        <span class="label">이름:</span>
        <span class="info">{{ name }}</span>
        <br>

        <span class="label">작성자:</span>
        <span class="info">{{ owner }}</span>
        <br>

        <span class="label">설명:</span>
        <span class="info">{{ description }}</span>
        <br>

        <span class="label">총 문제 개수:</span>
        <span class="info">{{ flashcards_count }}</span>
        <br>

        <span class="label">총 추천 수:</span>
        <span class="info">{{ total_votes }}</span>

        <br>
        <br>
        <!-- 누구든지 볼 수 있는 버튼: 문제 조회 버튼 -->
        <button
                id="quizButton"
                onclick=redirectToUrl('{{ request.path|escapejs }}cards/')
                {% if flashcards_count == 0 %}disabled{% endif %}>
        문제 조회
        </button>

        <!-- 누구든지 볼 수 있는 버튼: 문제 풀기 버튼 -->
        <button
                id="attemptQuizButton"
                onclick=redirectToUrl('{{ request.path|escapejs }}cards/{{ flashcard_ids.0 }}')
                {% if flashcards_count == 0 %}disabled{% endif %}>
                문제 풀기
        </button>
        <br>
        <!-- 작성자만 볼 수 있는 버튼: flashcard 추가 버튼  -->
        {% if user.student_id == owner %}
            <button class="btn-open-modal">문제 추가하기</button>
        {% endif %}


    </div>

    <!-- 버튼 관련 javascript -->
    <script>
        console.log("Deck flashcard ID:", {{ flashcard_ids }});
        // 동일한 동작을 수행하는 이벤트 리스너를 함수로 정의
        function handleMouseOver() {
        if ({{ flashcards_count }} === 0) {
          alert("문제가 존재하지 않습니다.");
        }
        }
        // 두 개의 버튼에 대해 동일한 이벤트 리스너 등록
        var buttons = document.querySelectorAll('#quizButton, #attemptQuizButton');

        buttons.forEach(function(button) {
        button.addEventListener('mouseover', handleMouseOver);
        });

        function redirectToUrl(url) {
          location.href = url;
        }
    </script>

{% endblock %}